package il.co;

import com.fasterxml.jackson.databind.ObjectMapper;

import javax.sound.sampled.*;
import java.io.BufferedInputStream;
import java.io.File;
import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.URL;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.*;

public class RedAlert
{
	public static void main(String... args) throws IOException, UnsupportedAudioFileException, LineUnavailableException
	{
		System.out.println("Preparing Red Alert listener...");
		try (Clip clip = AudioSystem.getClip();
		     AudioInputStream audioInputStream = AudioSystem.getAudioInputStream(new BufferedInputStream(Objects.requireNonNull(RedAlert.class.getResourceAsStream("/alarmSound.wav")))))
		{
			final String[] DISTRICTS = new String[]{
					"אזור תעשייה שחורת",
					"אילות",
					"אילת",
					"אבו-גוש",
					"אביעזר",
					"אבן ספיר",
					"אדרת",
					"אורה",
					"אזור תעשייה ברוש",
					"אזור תעשייה הר טוב - צרעה",
					"אשתאול",
					"בית זית",
					"בית מאיר",
					"בית נקופה",
					"בית שמש",
					"בקוע",
					"בר גיורא",
					"גבעות עדן",
					"גבעת יערים",
					"גבעת ישעיהו",
					"גיזו",
					"גפן",
					"הר אדר",
					"הראל",
					"זכריה",
					"זנוח",
					"טל שחר",
					"יד השמונה",
					"ישעי",
					"כסלון",
					"כפר אוריה",
					"כפר זוהרים",
					"לוזית",
					"לטרון",
					"מבוא ביתר",
					"מבשרת ציון",
					"מוצא עילית",
					"מחסיה",
					"מטע",
					"מסילת ציון",
					"מעלה החמישה",
					"נווה אילן",
					"נווה מיכאל - רוגלית",
					"נווה שלום",
					"נחושה",
					"נחם",
					"נחשון",
					"נטף",
					"נס הרים",
					"נתיב הל''ה",
					"עגור",
					"עין נקובא",
					"עין ראפה",
					"עמינדב",
					"צובה",
					"צור הדסה",
					"צלפון",
					"צפרירים",
					"צרעה",
					"קריית יערים",
					"קריית ענבים",
					"רטורנו - גבעת שמש",
					"רמת רזיאל",
					"שדות מיכה",
					"שואבה",
					"שורש",
					"שריגים - ליאון",
					"תירוש",
					"תעוז",
					"תרום",
					"ארגמן",
					"בקעות",
					"גיתית",
					"גלגל",
					"חמדת",
					"חמרה",
					"ייט''ב",
					"יפית",
					"מבואות יריחו",
					"מחולה",
					"מכורה",
					"מעלה אפרים",
					"משואה",
					"משכיות",
					"נעמה",
					"נערן",
					"נתיב הגדוד",
					"פצאל",
					"רועי",
					"רותם",
					"שדמות מחולה",
					"תומר",
					"אזור תעשייה צבאים",
					"בית אלפא וחפציבה",
					"בית השיטה",
					"בית יוסף",
					"בית שאן",
					"גשר",
					"חוות עדן",
					"חמדיה",
					"חפציבה ובית אלפא",
					"טירת צבי",
					"ירדנה",
					"כפר גמילה מלכישוע",
					"כפר רופין",
					"מולדת",
					"מירב",
					"מנחמיה",
					"מסילות",
					"מעוז חיים",
					"מעלה גלבוע",
					"נווה אור",
					"נווה איתן",
					"ניר דוד",
					"עין הנצי''ב",
					"רוויה",
					"רחוב",
					"רשפים",
					"שדה אליהו",
					"שדה נחום",
					"שדי תרומות",
					"שלוחות",
					"שלפים",
					"תל תאומים",
					"אבני איתן",
					"אודם",
					"אורטל",
					"אזור תעשייה בני יהודה",
					"אל רום",
					"אלוני הבשן",
					"אלי עד",
					"אפיק",
					"בוקעתא",
					"בני יהודה וגבעת יואב",
					"גבעת יואב ובני יהודה",
					"גשור",
					"חמת גדר",
					"חספין",
					"יונתן",
					"כפר חרוב",
					"מבוא חמה",
					"מג'דל שמס",
					"מיצר",
					"מסעדה",
					"מרום גולן",
					"נאות גולן",
					"נוב",
					"נווה אטי''ב",
					"נטור",
					"נמרוד",
					"עין זיוון",
					"עין קנייא",
					"קשת",
					"רמת מגשימים",
					"Kamanneh",
					"אבו סנאן",
					"אור הגנוז",
					"אזור תעשייה חצור הגלילית",
					"אזור תעשייה כרמיאל",
					"אזור תעשייה צ.ח.ר",
					"איילת השחר",
					"אליפלט",
					"אמירים",
					"אמנון",
					"אשרת",
					"בוסתן הגליל",
					"ביריה",
					"בית ג'אן",
					"בית העמק",
					"בענה",
					"בר יוחאי",
					"גדות",
					"ג'דידה מכר",
					"ג'וליס",
					"גילון צורית",
					"גיתה",
					"דיר אל-אסד",
					"הר-חלוץ",
					"חולתה",
					"חצור הגלילית",
					"חרשים",
					"טובא זנגריה",
					"טל-אל",
					"ינוח-ג'ת",
					"יסוד המעלה",
					"ירכא",
					"כורזים ורד הגליל",
					"כחל",
					"כיסרא",
					"כישור",
					"כליל",
					"כפר הנשיא",
					"כפר יסיף",
					"כפר מסריק",
					"כפר שמאי",
					"כרכום",
					"כרמיאל",
					"לבון",
					"לוחמי הגטאות",
					"לפידות",
					"מג'דל כרום",
					"מגדל תפן",
					"מזרעה",
					"מחניים",
					"מירון",
					"מנחת מחניים",
					"משמר הירדן",
					"נחף",
					"נס עמים",
					"נתיב השיירה",
					"סאג'ור",
					"סמיע",
					"ספסופה - כפר חושן",
					"עין אל אסד",
					"עין המפרץ",
					"עין כמונים",
					"עכו",
					"עכו - אזור תעשייה",
					"עמוקה",
					"עמיעד",
					"עמקה",
					"פלך",
					"פרוד",
					"צורית גילון",
					"צפת",
					"קדיתא",
					"קדרים",
					"ראמה",
					"ראש פינה",
					"רגבה",
					"שדה אליעזר",
					"שומרת",
					"שזור",
					"שייח' דנון",
					"שפר",
					"תובל",
					"אבטליון",
					"אוהלו ובית ירח",
					"אזור תעשייה בר-לב",
					"אזור תעשייה צמח",
					"אזור תעשייה קדמת גליל",
					"אזור תעשייה תרדיון",
					"אחיהוד",
					"אילניה",
					"אלומות",
					"אעבלין",
					"אפיקים",
					"אפק",
					"ארבל",
					"אשבל",
					"אשדות יעקב איחוד",
					"אשדות יעקב מאוחד",
					"אשחר",
					"בועיינה-נוג'ידאת",
					"ביר אלמכסור",
					"בית זרע",
					"בית קשת",
					"בית רימון",
					"גינוסר",
					"דגניה א",
					"דגניה ב",
					"דיר חנא",
					"דמיידה",
					"הודיות",
					"הזורעים",
					"המכללה האקדמית כנרת",
					"הר כמון - מזרח",
					"הר כמון - מערב",
					"הררית יחד",
					"חוסנייה",
					"חוקוק",
					"חזון",
					"טבריה",
					"טמרה",
					"טפחות",
					"יבנאל",
					"יובלים",
					"יודפת",
					"יסעור",
					"יעד",
					"כאבול",
					"כאוכב אבו אלהיג'א",
					"כדורי",
					"כינרת מושבה",
					"כינרת קבוצה",
					"כלנית",
					"כפר זיתים",
					"כפר חיטים",
					"כפר חנניה",
					"כפר כמא",
					"כפר מנדא",
					"לביא",
					"לבנים",
					"לוטם וחמדון",
					"מגדל",
					"מורן",
					"מורשת",
					"מנוף",
					"מסד",
					"מע'אר",
					"מעלה צביה",
					"מצפה",
					"מצפה אבי''ב",
					"מצפה נטופה",
					"מרכז אזורי משגב",
					"סכנין",
					"סלמה",
					"עילבון",
					"עינבר",
					"עצמון - שגב",
					"עראבה",
					"ערב אל-נעים",
					"פוריה כפר עבודה",
					"פוריה נווה עובד",
					"פוריה עילית",
					"קורנית",
					"ראס אל-עין",
					"רביד",
					"רקפת",
					"שדה אילן",
					"שדמות דבורה",
					"שורשים",
					"שכניה",
					"שעב",
					"שפרעם",
					"שרונה",
					"אור יהודה",
					"אזור",
					"בני ברק",
					"בת-ים",
					"גבעת שמואל",
					"גבעתיים",
					"גני תקווה",
					"חולון",
					"יהוד-מונוסון",
					"מקווה ישראל",
					"סביון",
					"קריית אונו",
					"רמת גן - מזרח",
					"רמת גן - מערב",
					"תל אביב - דרום העיר ויפו",
					"תל אביב - מזרח",
					"תל אביב - מרכז העיר",
					"תל אביב - עבר הירקון",
					"Al-Sayyid",
					"אבו קרינאת והפזורה",
					"אבו-תלול והפזורה",
					"אום בטין והפזורה",
					"אזור תעשייה דימונה",
					"אזור תעשייה רותם",
					"אשלים",
					"באר מילכה",
					"ביר הדאג'",
					"בית סוהר נפחא",
					"דימונה",
					"דריג'את, תל ערד ואל פורה",
					"ואדי אל נעם",
					"חורה",
					"טללים",
					"ירוחם",
					"כוחלה מכחול",
					"כמהין",
					"כסייפה והפזורה",
					"מדרשת בן גוריון",
					"מולדה, אל-סייד והפזורה",
					"מכחול וכוחלה",
					"מצפה רמון",
					"מרחב עם",
					"משאבי שדה",
					"מתחם צומת שוקת",
					"ניצנה",
					"עבדת",
					"עזוז",
					"ערד",
					"ערוער - ערערה בנגב",
					"קדש ברנע",
					"קצר-א-סיר והפזורה",
					"רביבים",
					"רתמים",
					"שאנטי במדבר",
					"שגב שלום והפזורה",
					"שדה בוקר",
					"תל שבע",
					"בית אלעזרי",
					"בית גמליאל",
					"בית חלקיה",
					"בן זכאי",
					"בני דרום",
					"בני ראם",
					"בניה",
					"גבעת ברנר",
					"גבעת וושינגטון",
					"גדרה",
					"גיבתון",
					"גן הדרום",
					"גן שלמה",
					"גני טל",
					"חפץ חיים",
					"יבנה",
					"יד בנימין",
					"יסודות",
					"כפר אביב",
					"כפר מרדכי",
					"כרם ביבנה",
					"מזכרת בתיה",
					"מישר",
					"מעון צופיה",
					"משגב דב",
					"מתחם בני דרום",
					"ניר גלים",
					"נצר חזני",
					"עשרת",
					"קבוצת יבנה",
					"קדרון",
					"קריית עקרון",
					"שדמה",
					"Kfar Hassidim",
					"אורנים",
					"אושה",
					"אזור תעשייה שער נעמן",
					"איבטין",
					"אל-ח'וואלד מערב",
					"בית עלמין תל רגב",
					"בסמת טבעון",
					"ח'וואלד",
					"יגור",
					"כפר ביאליק",
					"כפר המכבי",
					"כפר חסידים",
					"כפר תקווה",
					"נופית",
					"קריית ביאליק",
					"קריית טבעון",
					"קריית ים",
					"קריית מוצקין",
					"קרית אתא",
					"ראס עלי",
					"רכסים",
					"רמת יוחנן",
					"שער העמקים",
					"Kerem BenShemen",
					"אזור תעשייה נשר - רמלה",
					"אחיסמך",
					"אחיעזר",
					"אירוס",
					"באר יעקב",
					"בית דגן",
					"בית חנן",
					"בית חשמונאי",
					"בית עובד",
					"בית עוזיאל",
					"בן שמן",
					"גאליה",
					"גזר",
					"גינתון",
					"גמזו",
					"גן שורק",
					"גנות",
					"גני הדר",
					"גני יוחנן",
					"זיתן",
					"חולדה",
					"חמד",
					"יגל",
					"יד רמב''ם",
					"יציץ",
					"ישרש",
					"כפר ביל''ו",
					"כפר בן נון",
					"כפר דניאל",
					"כפר הנגיד",
					"כפר חב''ד",
					"כפר נוער בן שמן",
					"כפר רות",
					"כפר שמואל",
					"כרמי יוסף",
					"לוד",
					"לפיד",
					"מבוא מודיעים",
					"מודיעין",
					"מודיעין - ישפרו סנטר",
					"מודיעין - ליגד סנטר",
					"מצליח",
					"משמר איילון",
					"משמר דוד",
					"משמר השבעה",
					"נוף איילון",
					"נטעים",
					"ניר צבי",
					"נס ציונה",
					"נען",
					"נצר סרני",
					"סתריה",
					"עזריה",
					"עיינות",
					"פארק תעשיות פלמחים",
					"פדיה",
					"פלמחים",
					"פתחיה",
					"צפריה",
					"ראשון לציון - מזרח",
					"ראשון לציון - מערב",
					"רחובות",
					"רמות מאיר",
					"רמלה",
					"שילת",
					"שעלבים",
					"תעשיון צריפין",
					"אום אל פחם",
					"אום אל קוטוף",
					"אל עריאן",
					"באקה אל גרבייה",
					"בסמ\"ה",
					"ברטעה",
					"ברקאי",
					"ג'ת",
					"חריש",
					"כפר קרע",
					"להבות חביבה",
					"מגל",
					"מועאוויה",
					"מי עמי",
					"מייסר",
					"מעלה עירון",
					"מצפה אילן",
					"מצר",
					"עין אל-סהלה",
					"ערערה",
					"קציר",
					"אזור תעשייה ניר עציון",
					"בית צבי",
					"בת שלמה",
					"גבע כרמל",
					"דור",
					"הבונים",
					"כפר הנוער ימין אורד",
					"כרם מהר''ל",
					"מאיר שפיה",
					"מגדים",
					"מרכז מיר''ב",
					"נווה ים",
					"נחשולים",
					"ניר עציון",
					"עופר",
					"עין איילה",
					"עין הוד",
					"עין חוד",
					"עין כרמל",
					"עתלית",
					"פוריידיס",
					"צרופה",
					"החותרים",
					"חיפה - כרמל ועיר תחתית",
					"חיפה - מערב",
					"חיפה - מפרץ והקריות",
					"חיפה - נווה שאנן ורמות כרמל",
					"טירת כרמל",
					"כפר גלים",
					"נשר",
					"אביחיל",
					"אזור תעשייה טירה",
					"אזור תעשייה עמק חפר",
					"אחיטוב",
					"אייל",
					"אליכין",
					"אלישיב",
					"אמץ",
					"בארותיים",
					"בורגתה",
					"בחן",
					"בית הלוי",
					"בית חזון",
					"בית חרות",
					"בית ינאי",
					"בית יצחק - שער חפר",
					"ביתן אהרן",
					"בני דרור",
					"בת חן",
					"בת חפר",
					"גאולי תימן",
					"גאולים",
					"גבעת חיים איחוד",
					"גבעת חיים מאוחד",
					"גבעת שפירא",
					"גן יאשיה",
					"גנות הדר",
					"הדר עם",
					"המעפיל",
					"המרכז האקדמי רופין",
					"העוגן",
					"זמר",
					"חבצלת השרון וצוקי ים",
					"חגלה",
					"חופית",
					"חיבת ציון",
					"חניאל",
					"חרב לאת",
					"חרות",
					"טייבה",
					"טירה",
					"יד חנה",
					"ינוב",
					"יעף",
					"כפר הס",
					"כפר הרא''ה",
					"כפר ויתקין",
					"כפר חיים",
					"כפר ידידיה",
					"כפר יונה",
					"כפר יעבץ",
					"כפר מונש",
					"כפר עבודה",
					"מכמורת",
					"מעברות",
					"משמר השרון",
					"משמרת",
					"נורדיה",
					"ניצני עוז",
					"נעורים",
					"עולש",
					"עזריאל",
					"עין החורש",
					"עין ורד",
					"עין שריד",
					"פורת",
					"פרדסיה",
					"צוקי ים וחבצלת השרון",
					"צור יצחק",
					"צור משה",
					"צור נתן",
					"צורן",
					"קדימה",
					"קלנסווה",
					"רמת הכובש",
					"שושנת העמקים",
					"שער אפרים",
					"תל מונד",
					"תנובות",
					"אדורה",
					"אזור תעשייה מיתרים",
					"אלון",
					"אלון שבות",
					"אליאב",
					"אלעזר",
					"אמציה",
					"אפרת",
					"אשכולות",
					"בית חגי",
					"בית יתיר",
					"ביתר עילית",
					"בני דקלים",
					"בת עין",
					"גבעות",
					"הר גילה",
					"הר עמשא",
					"חברון",
					"חוות שדה בר",
					"טנא עומרים",
					"כפר אדומים",
					"כפר אלדד",
					"כפר עציון",
					"כרמי צור",
					"כרמי קטיף",
					"כרמל",
					"מגדל עוז",
					"מיצד",
					"מעון",
					"מעלה אדומים",
					"מעלה חבר",
					"מעלה עמוס",
					"מצפה יריחו",
					"נגוהות",
					"נווה דניאל",
					"נופי פרת",
					"נוקדים",
					"נטע",
					"סוסיה",
					"סנסנה",
					"עלמון",
					"עתניאל",
					"פני קדם",
					"קדר",
					"קרית ארבע",
					"ראש צורים",
					"שמעה",
					"שני ליבנה",
					"שקף",
					"תלם",
					"תקוע",
					"אבנת",
					"אלמוג",
					"בית הערבה",
					"בתי מלון ים המלח",
					"ורד יריחו",
					"מלונות ים המלח מרכז",
					"מצדה",
					"מצוקי דרגות",
					"מצפה שלם",
					"מרחצאות עין גדי",
					"נאות הכיכר",
					"נווה זוהר",
					"עין בוקק",
					"עין גדי",
					"עין תמר",
					"קליה",
					"בית אורן",
					"גבעת וולפסון",
					"דלית אל כרמל",
					"יערות הכרמל",
					"כלא דמון",
					"עספיא",
					"Ramat Rachel",
					"גבעת זאב",
					"ירושלים - אזור תעשייה עטרות",
					"ירושלים - מזרח, מרכז ומערב",
					"ירושלים - צפון ואלונים",
					"ירושלים - רובע אורנים",
					"ירושלים - רובע דרום",
					"אזור תעשייה אפק ולב הארץ",
					"אלעד",
					"בארות יצחק",
					"בית נחמיה",
					"בית עריף",
					"בני עטרות",
					"ברקת",
					"גבעת השלושה",
					"גבעת כ''ח",
					"גת רימון",
					"חדיד",
					"טירת יהודה",
					"כפר טרומן",
					"כפר סירקין",
					"מגשימים",
					"מזור",
					"מעש",
					"נופך",
					"נחלים",
					"נחשונים",
					"עינת",
					"פתח תקווה",
					"ראש העין",
					"רינתיה",
					"שהם",
					"תעשיון חצב",
					"אביגדור",
					"אבן שמואל",
					"אורות",
					"אזור תעשייה כנות",
					"אזור תעשייה עד הלום",
					"אזור תעשייה תימורים",
					"אחווה",
					"אחוזם",
					"איתן",
					"אל עזי",
					"אלומה",
					"אמונים",
					"אשדוד - א,ב,ד,ה",
					"אשדוד - אזור תעשייה צפוני ונ",
					"אשדוד - ג,ו,ז",
					"אשדוד - ח,ט,י,יג,יד,טז",
					"אשדוד - יא,יב,טו,יז,מרינה",
					"באר טוביה",
					"ביצרון",
					"בית גוברין",
					"בית ניר",
					"בית עזרא",
					"בני עי''ש",
					"גבעתי",
					"גלאון",
					"גן יבנה",
					"גת",
					"ורדון",
					"זבדיאל",
					"זוהר",
					"זרחיה",
					"חצב",
					"חצור",
					"יד נתן",
					"ינון",
					"כנות",
					"כפר אחים",
					"כפר הרי''ף וצומת ראם",
					"כפר ורבורג",
					"כפר מנחם",
					"לכיש",
					"מנוחה",
					"מרכז שפירא",
					"משואות יצחק",
					"נגבה",
					"נהורה",
					"נוגה",
					"נווה מבטח",
					"נועם",
					"נחלה",
					"ניר בנים",
					"ניר ח''ן",
					"סגולה",
					"עוזה",
					"עוצם",
					"עזר",
					"עזריקם",
					"עין צורים",
					"ערוגות",
					"פארק תעשייה ראם",
					"קדמה",
					"קוממיות",
					"קריית גת, כרמי גת",
					"קריית מלאכי",
					"רבדים",
					"רווחה",
					"שדה דוד",
					"שדה יואב",
					"שדה משה",
					"שדה עוזיהו",
					"שחר",
					"שלווה",
					"שפיר",
					"שתולים",
					"תימורים",
					"תלמי יחיאל",
					"תלמים",
					"אביאל",
					"אור עקיבא",
					"אזור תעשייה יקנעם עילית",
					"אזור תעשייה מבוא כרמל",
					"אזור תעשייה קיסריה",
					"אזור תעשייה רגבים",
					"אלוני יצחק",
					"אליקים",
					"בית חנניה",
					"בית סוהר מגידו",
					"בית ספר אורט בנימינה",
					"בנימינה",
					"גבעת חביבה",
					"גבעת ניל''י",
					"גבעת עדה",
					"גבעת עוז",
					"גלעד - אבן יצחק",
					"גן השומרון",
					"גן שמואל",
					"ג'סר א-זרקא",
					"דליה",
					"הזורע ויקנעם המושבה",
					"זכרון יעקב",
					"חדרה - מזרח",
					"חדרה - מערב",
					"חדרה - מרכז",
					"חדרה - נווה חיים",
					"יקנעם המושבה והזורע",
					"יקנעם עילית",
					"כפר גליקסון",
					"כפר פינס",
					"כרכור",
					"מאור",
					"מגידו",
					"מדרך עוז",
					"מעגן מיכאל",
					"מעיין צבי",
					"מענית",
					"מרכז ימי קיסריה",
					"משמר העמק",
					"משמרות",
					"עין העמק",
					"עין השופט",
					"עין עירון",
					"עין שמר",
					"עמיקם",
					"פרדס חנה",
					"קיסריה",
					"רגבים",
					"רמות מנשה",
					"רמת הנדיב",
					"רמת השופט",
					"שדה יצחק",
					"שדות ים",
					"שער מנשה",
					"תלמי אלעזר",
					"אופקים",
					"אורים",
					"אשבול",
					"אשל הנשיא",
					"בטחה",
					"בית הגדי",
					"ברור חיל",
					"ברוש",
					"גבולות",
					"גבעולים מעגלים מלילות",
					"גילת",
					"דורות",
					"זרועה",
					"חוות שיקמים",
					"יושיביה",
					"מבועים",
					"מלילות גבעולים מעגלים",
					"מסלול",
					"מעגלים גבעולים מלילות",
					"ניר משה",
					"ניר עקיבא",
					"נתיבות",
					"פדויים",
					"פטיש",
					"פעמי תש''ז",
					"צאלים",
					"קלחים",
					"קרית חינוך מרחבים",
					"רוחמה",
					"רנן",
					"שבי דרום",
					"שדה צבי",
					"שיבולים",
					"שרשרת",
					"תאשור",
					"תדהר",
					"תלמי ביל''ו",
					"תפרח",
					"Nitzan",
					"אזור תעשייה הדרומי אשקלון",
					"אזור תעשייה צפוני אשקלון",
					"אשקלון",
					"באר גנים",
					"בית שקמה",
					"ברכיה",
					"בת הדר",
					"גיאה",
					"הודיה",
					"חלץ",
					"כוכב מיכאל",
					"כפר סילבר",
					"מבקיעים",
					"משען",
					"ניצן",
					"ניצנים",
					"ניר ישראל",
					"תלמי יפה",
					"אזור תעשייה עידן הנגב",
					"באר שבע - דרום",
					"באר שבע - מזרח",
					"באר שבע - מערב",
					"באר שבע - צפון",
					"בית קמה",
					"גבעות בר",
					"דביר",
					"חצרים",
					"כרמים",
					"כרמית",
					"להב",
					"להבים",
					"לקיה והפזורה",
					"מיתר",
					"משמר הנגב",
					"נאות חובב",
					"נבטים",
					"עומר",
					"רהט והפזורה",
					"שובל",
					"שומריה",
					"תראבין א-צאנע ופזורה",
					"Kfar Maimon and Tushia",
					"אבשלום",
					"אוהד וצוחר",
					"אור הנר",
					"איבים, שדרות",
					"ארז",
					"בארי",
					"בני נצרים",
					"גבים, מכללת ספיר",
					"גברעם",
					"דקל",
					"זיקים",
					"זמרת ושובה",
					"חולית",
					"יבול",
					"יד מרדכי",
					"יכיני",
					"ישע, מבטחים, עמיעוז",
					"יתד",
					"כיסופים",
					"כפר מימון ותושיה",
					"כפר עזה",
					"כרם שלום",
					"כרמיה",
					"מבטחים עמיעוז ישע",
					"מגן",
					"מטווח ניר עם",
					"מפלסים",
					"נווה",
					"נחל עוז",
					"ניר יצחק",
					"ניר עוז",
					"ניר עם",
					"נירים",
					"נתיב העשרה",
					"סופה",
					"סעד",
					"עין הבשור",
					"עין השלושה",
					"עלומים",
					"עמיעוז, מבטחים, ישע",
					"פרי גן",
					"צוחר ואוהד",
					"רעים",
					"שדה אברהם",
					"שדה ניצן",
					"שדרות, איבים",
					"שובה וזמרת",
					"שוקדה",
					"שלומית",
					"תלמי אליהו",
					"תלמי יוסף",
					"תקומה",
					"תקומה וחוות יזרעם",
					"אליפז ומכרות תמנע",
					"באר אורה",
					"גרופית",
					"חוות ערנדל",
					"חי-בר יטבתה",
					"חצבה",
					"יהל",
					"יטבתה",
					"כושי רמון",
					"לוטן",
					"נאות סמדר",
					"נווה חריף",
					"סמר",
					"ספיר",
					"עידן",
					"עין חצבה",
					"עין יהב",
					"עיר אובות",
					"פארן",
					"צופר",
					"צוקים",
					"קטורה",
					"שחרות",
					"שיטים",
					"Peki'in HaHadasha",
					"אביבים",
					"אבירים",
					"אבן מנחם",
					"אדמית",
					"אזור תעשייה אכזיב מילואות",
					"אזור תעשייה רמת דלתון",
					"אילון",
					"אלקוש",
					"בית הלל",
					"בית ספר שדה מירון",
					"בן עמי",
					"בצת",
					"ברעם",
					"גונן",
					"גורן",
					"געתון",
					"גרנות הגליל",
					"ג'ש - גוש חלב",
					"גשר הזיו",
					"דוב''ב",
					"דישון",
					"דלתון",
					"דן",
					"דפנה",
					"הגושרים",
					"הילה",
					"זרעית",
					"חוסן",
					"חורפיש",
					"חניתה",
					"יובל",
					"יחיעם",
					"יערה",
					"יפתח",
					"יראון",
					"כברי",
					"כפר בלום",
					"כפר גלעדי",
					"כפר ורדים",
					"כפר סאלד",
					"כרם בן זמרה",
					"להבות הבשן",
					"לימן",
					"מטולה",
					"מלכיה",
					"מנות",
					"מנרה",
					"מעונה",
					"מעיין ברוך",
					"מעיליא",
					"מעלות תרשיחא",
					"מצובה",
					"מרגליות",
					"משגב עם",
					"מתת",
					"נאות מרדכי",
					"נהריה",
					"נווה זיו",
					"נטועה",
					"סאסא",
					"סער",
					"עבדון",
					"עברון",
					"עג'ר",
					"עין יעקב",
					"עלמה",
					"עמיר",
					"ערב אל עראמשה",
					"פסוטה",
					"פקיעין",
					"צבעון",
					"צוריאל",
					"קרית שמונה",
					"ראש הנקרה",
					"ריחאנייה",
					"רמות נפתלי",
					"שאר ישוב",
					"שבי ציון",
					"שדה נחמיה",
					"שומרה",
					"שלומי",
					"שמיר",
					"שניר",
					"שתולה",
					"תל חי",
					"אלמגור",
					"אניעם",
					"גבעת אבני",
					"האון",
					"חד נס",
					"כנף",
					"כפר קיש",
					"מסדה",
					"מעגן",
					"מעלה גמלא",
					"עין גב",
					"קדמת צבי",
					"קלע",
					"קצרין",
					"קצרין - אזור תעשייה",
					"רמות",
					"שעל",
					"שער הגולן",
					"תל קציר",
					"Giv'on HaHadasha",
					"אבני חפץ",
					"אורנית",
					"אזור תעשייה בראון",
					"אזור תעשייה שער בנימין",
					"אחיה",
					"איתמר",
					"אלון מורה",
					"אלפי מנשה",
					"אלקנה",
					"אריאל",
					"בית אל",
					"בית אריה",
					"בית חורון",
					"ברוכין",
					"ברקן",
					"גבע בנימין",
					"גני מודיעין",
					"דולב",
					"הר ברכה",
					"חוות יאיר",
					"חיננית",
					"חלמיש",
					"חרמש",
					"חרשה",
					"חשמונאים",
					"טל מנשה",
					"טלמון",
					"יצהר",
					"יקיר",
					"כוכב השחר",
					"כוכב יאיר - צור יגאל",
					"כוכב יעקב",
					"כפר האורנים",
					"כפר תפוח",
					"מבוא דותן",
					"מבוא חורון",
					"מגדלים",
					"מגרון",
					"מודיעין עילית",
					"מעלה לבונה",
					"מעלה מכמש",
					"מעלה שומרון",
					"מתתיהו",
					"נבי סמואל",
					"נופי נחמיה",
					"נופים",
					"נחליאל",
					"ניל''י",
					"נעלה",
					"נריה",
					"סלעית",
					"עדי עד",
					"עופרים",
					"עטרת",
					"עלי",
					"עלי זהב",
					"עמיחי",
					"עמנואל",
					"ענב",
					"עפרה",
					"עץ אפרים",
					"פדואל",
					"פסגות",
					"צופין",
					"קדומים",
					"קידה",
					"קריית נטפים",
					"קרני שומרון",
					"רבבה",
					"רחלים",
					"ריחן",
					"רימונים",
					"שבות רחל",
					"שבי שומרון",
					"שילה",
					"שערי תקווה",
					"שקד",
					"תל ציון",
					"אבן יהודה",
					"אודים",
					"אלישמע",
					"ארסוף",
					"בית ברל",
					"בית יהושע",
					"בית סוהר השרון",
					"בני ציון",
					"בצרה",
					"גבעת חן",
					"ג'לג'וליה",
					"גן חיים",
					"גני עם",
					"געש",
					"הוד השרון",
					"הרצליה - גליל ים ומרכז",
					"הרצליה - מרכז וגליל ים",
					"הרצליה - פיתוח",
					"חגור",
					"חורשים",
					"חרוצים",
					"יקום",
					"ירחיב",
					"ירקונה",
					"כפר ברא",
					"כפר מל''ל",
					"כפר נטר",
					"כפר סבא",
					"כפר קאסם",
					"כפר שמריהו",
					"מכון וינגייט",
					"מתן",
					"נווה ימין",
					"נווה ירק",
					"ניר אליהו",
					"נירית",
					"נתניה - מזרח",
					"נתניה - מערב",
					"עדנים",
					"צופית",
					"רמות השבים",
					"רמת השרון",
					"רעננה",
					"רשפון",
					"שדה ורבורג",
					"שדי חמד",
					"שפיים",
					"תל יצחק",
					"Adirim",
					"Dvora",
					"Ein Harod (Ihud)",
					"Gadish",
					"Meitav",
					"Meitav",
					"Merkaz Hever",
					"Merkaz Omen",
					"Mle'a",
					"Nir Yafeh",
					"Prazon",
					"Yael",
					"אום אל-גנם",
					"אזור תעשייה מבואות הגלבוע",
					"אחוזת ברק",
					"אכסאל",
					"אלון הגליל",
					"אלוני אבא",
					"אלונים",
					"אתר ההנצחה גולני",
					"בית זייד",
					"בית לחם הגלילית",
					"בית סוהר שיטה וגלבוע",
					"בית שערים",
					"בלפוריה",
					"גבע",
					"גבעת אלה",
					"גבת",
					"גדעונה",
					"גזית",
					"גן נר",
					"גניגר",
					"דבוריה",
					"דברת",
					"דחי",
					"הושעיה",
					"היוגב",
					"הסוללים",
					"הרדוף",
					"ואדי אל חמאם",
					"זרזיר",
					"חג'אג'רה",
					"חנתון",
					"טורעאן",
					"טייבה בגלבוע",
					"טמרה בגלבוע",
					"יזרעאל",
					"יפיע",
					"יפעת",
					"ישובי אמן",
					"ישובי חבר",
					"ישובי יעל",
					"ישובי יעל.",
					"כעביה",
					"כעביה טבאש",
					"כעביה-טבאש-חג'אג'רה",
					"כפר ברוך",
					"כפר גדעון",
					"כפר החורש",
					"כפר טבאש",
					"כפר יהושע",
					"כפר יחזקאל",
					"כפר כנא",
					"כפר מיסר",
					"כפר נהר הירדן",
					"כפר תבור",
					"מגדל העמק",
					"מגן שאול",
					"מוקייבלה",
					"מזרע",
					"מנשית זבדה",
					"מרחביה מושב",
					"מרחביה קיבוץ",
					"משהד",
					"נאעורה",
					"נהלל",
					"נורית",
					"נין",
					"נצרת",
					"נצרת עילית (נוף הגליל)",
					"סואעד חמירה",
					"סולם",
					"סנדלה",
					"עדי",
					"עוזייר",
					"עילוט",
					"עין דור",
					"עין חרוד",
					"עין מאהל",
					"עפולה",
					"ציפורי",
					"רומאנה",
					"רומת אל הייב",
					"ריינה",
					"רם און",
					"רמת דוד",
					"רמת ישי",
					"רמת צבי",
					"שבלי",
					"שדה יעקב",
					"שמשית",
					"שריד",
					"תל יוסף",
					"תל עדשים",
			};
			Arrays.parallelSort(DISTRICTS);
			clip.open(audioInputStream);
			final URL url = new URL("https://www.oref.org.il/WarningMessages/alert/alerts.json");
			final ObjectMapper MAPPER = new ObjectMapper();
			final SimpleDateFormat SIMPLE_DATE_FORMAT = new SimpleDateFormat("EEE, dd MMM yyyy HH:mm:ss zzz", Locale.US);
			final File FILE = new File("red-alert-settings.json");
			long currLastModified = 0, fileLastModified = 0;
			Settings settings = null;
			List<String> districtsNotFound = null;
			System.out.println("Listening...");
			while (true)
				try
				{
					if (url.openConnection() instanceof HttpURLConnection httpURLConnection)
					{
						httpURLConnection.setRequestProperty("Referer", "https://www.oref.org.il/12481-he/Pakar.aspx");
						httpURLConnection.setRequestProperty("X-Requested-With", "XMLHttpRequest");
						httpURLConnection.setConnectTimeout(5000);
						httpURLConnection.setReadTimeout(5000);
						httpURLConnection.setUseCaches(false);

						final Date lastModified;
						final long contentLength = httpURLConnection.getContentLengthLong();
						if (contentLength > 0 && (lastModified = SIMPLE_DATE_FORMAT.parse(httpURLConnection.getHeaderField("last-modified"))).getTime() > currLastModified)
						{
							currLastModified = lastModified.getTime();
							final List<String> data = MAPPER.readValue(httpURLConnection.getInputStream(), RedAlertResponse.class).data();
							System.out.println(new StringBuilder("Content Length: ").append(contentLength).append(" bytes").append(System.lineSeparator())
									.append("Last Modified Date: ").append(lastModified).append(System.lineSeparator())
									.append("Current Date: ").append(new Date()).append(System.lineSeparator())
									.append("Response: ").append(data));

							long fileLastModifiedTemp;
							if ((fileLastModifiedTemp = FILE.lastModified()) > fileLastModified)
							{
								fileLastModified = fileLastModifiedTemp;
								settings = MAPPER.readValue(FILE, Settings.class);
								districtsNotFound = settings.areasOfInterest().stream()
										.filter(district -> Arrays.binarySearch(DISTRICTS, district) < 0)
										.toList();
							} else if (fileLastModifiedTemp == 0)
							{
								settings = null;
								fileLastModified = 0;
								districtsNotFound = null;
							}
							if (districtsNotFound != null && !districtsNotFound.isEmpty())
								System.out.println("Warning: those districts don't exist: " + districtsNotFound);
							if (settings != null)
							{
								final List<String> importantAreas = (data.size() > settings.areasOfInterest().size() ?
										data.parallelStream()
												.filter(settings.areasOfInterest()::contains) :
										settings.areasOfInterest().parallelStream()
												.filter(data::contains))
										.toList();
								if (settings.isMakeSound() && (settings.isAlertAll() || !importantAreas.isEmpty()))
								{
									clip.setFramePosition(0);
									clip.loop(settings.soundLoopCount());
								}
								if (!importantAreas.isEmpty())
									System.out.println("ALERT: " + importantAreas);
							} else
								System.out.println("Warning: Settings file doesn't exists!");
						}
					} else
						System.out.println("Error: Not a HTTP connection!");
				} catch (IOException | ParseException e)
				{
					e.printStackTrace();
				}
		}
	}

	public static final record RedAlertResponse(List<String> data, long id, String title)
	{
	}

	public static final record Settings(boolean isMakeSound, boolean isAlertAll, int soundLoopCount,
	                                    List<String> areasOfInterest)
	{
	}
}